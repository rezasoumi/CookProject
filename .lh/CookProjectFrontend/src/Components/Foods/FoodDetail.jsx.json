{
    "sourceFile": "CookProjectFrontend/src/Components/Foods/FoodDetail.jsx",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 0,
            "patches": [
                {
                    "date": 1678258392830,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                }
            ],
            "date": 1678258392830,
            "name": "Commit-0",
            "content": "import React, { useEffect, useState } from \"react\";\r\nimport { useParams } from \"react-router-dom\";\r\nimport element from \"../../images/nodel-ba-panir.jpg\";\r\nimport author from \"../../images/author.jpg\";\r\nimport Rating from \"@mui/material/Rating\";\r\nimport PageBanner from \"../Banner/PageBanner.js\";\r\nimport chief_profile_img from \"../../images/chief_profile.jpg\";\r\nimport author_avatar from \"../../images/author-avatar.png\";\r\nimport axios from \"axios\";\r\nimport {BASE_API, check_error} from \"../../App\";\r\nimport Swal from 'sweetalert2';\r\n\r\nimport {\r\n  ChiefCard,\r\n  ChiefContainer,\r\n  ChiefH1,\r\n  ChiefH2,\r\n  ChiefImage,\r\n  ChiefP,\r\n  ChiefWrapper,\r\n} from \"./ForumStyle\";\r\nimport Sidebar from \"../Sidebar\";\r\nimport Navbar from \"../Navbar-second\";\r\nimport Grid from \"@mui/material/Grid\";\r\nimport { useForm } from \"react-hook-form\";\r\nimport { updateLogin, useLogin } from \"../../hooks/useLogin\";\r\n\r\nfunction ForumDetail() {\r\n  const [Forum, setForum] = useState({});\r\n  const [followedForum, setFollowedForum] = useState(false);\r\n  const [followedChief, setFollowedChief] = useState(false);\r\n  const { register, handleSubmit } = useForm();\r\n  const [chiefDetail, setChiefDetail] = useState({});\r\n  const { chiefName, forumName, forumId } = useParams();\r\n  const user = useLogin();\r\n  const username = user.username;\r\n  const Swal = require('sweetalert2')\r\n\r\n  useEffect(() => {\r\n    const checkFollowedForum = async () => {\r\n      await axios\r\n        .get(BASE_API + `forums/${forumId}/checkFollowed`,{\r\n            params: {\r\n              username: username\r\n            },\r\n              headers: {\r\n                \"Content-Type\": \"application/json\",\r\n            },\r\n          }\r\n        )\r\n        .then((response) => {\r\n          console.log(response.data);\r\n          if (response.data == \"True\")\r\n            setFollowedForum(true); //results\r\n          else\r\n            setFollowedForum(false); //results\r\n        })\r\n        .catch((error) => {\r\n          console.log(\"error in get checking followed forum or not.\");\r\n        });\r\n    }\r\n\r\n    const checkFollowedChief = async () => {\r\n      await axios\r\n        .get(BASE_API + `accounts/${chiefName}/hasFollowed`,{\r\n            params: {\r\n              username: username\r\n            },\r\n              headers: {\r\n                \"Content-Type\": \"application/json\",\r\n            },\r\n          }\r\n        )\r\n        .then((response) => {\r\n          console.log(response.data);\r\n          if (response.data == \"True\")\r\n            setFollowedChief(true); //results\r\n          else\r\n            setFollowedChief(false); //results\r\n        })\r\n        .catch((error) => {\r\n          console.log(\"error in get checking followed forum or not.\");\r\n        });\r\n    }\r\n\r\n    const fetchData = async () => {\r\n      await axios\r\n        .get(BASE_API + \"forums/view\",{\r\n            params: {\r\n              forumId: 1,\r\n              username: username\r\n            },\r\n              headers: {\r\n                \"Content-Type\": \"application/json\",\r\n            },\r\n          }\r\n        )\r\n        .then((response) => {\r\n          console.log(response.data);\r\n          setForum(response.data); //results\r\n        })\r\n        .catch((error) => {\r\n          console.log(\"error in get forum info.\");\r\n        });\r\n    }\r\n    checkFollowedForum();\r\n    checkFollowedChief();\r\n    fetchData();\r\n  }, []);\r\n  \r\n  function follow_chief() {\r\n    axios\r\n        .put(BASE_API + `accounts/${chiefName}/follow/?username=${username}`,{\r\n            headers: {\r\n              \"Content-Type\": \"application/json\",\r\n            },\r\n          }\r\n        ).then((response)  => {\r\n          console.log(response.data);\r\n          setFollowedChief(true); //\r\n          Swal.fire({\r\n            title: 'Follow Chief',\r\n            text: `You follow chief ${chiefName} now`,\r\n            icon: 'success',\r\n          })\r\n        })\r\n        .catch((error) => {\r\n          console.log(\"error in follow chief.\");\r\n        });\r\n  }\r\n\r\n  function unfollow_chief() {\r\n    axios\r\n        .delete(BASE_API + `accounts/${chiefName}/unfollow/?username=${username}`,{\r\n            headers: {\r\n              \"Content-Type\": \"application/json\",\r\n            },\r\n          }\r\n        ).then((response)  => {\r\n          console.log(response.data)\r\n          setFollowedChief(false); //results\r\n          Swal.fire({\r\n            title: 'Unfollow Chief',\r\n            text: `You unfollow chief ${chiefName}`,\r\n            icon: 'success',\r\n          })\r\n        })\r\n        .catch((error) => {\r\n          console.log(\"error in follow chief.\");\r\n        });\r\n  }  \r\n  \r\n  function followForum() {\r\n    axios\r\n        .patch(BASE_API + `forums/${forumId}/join/?username=${username}`,{\r\n              headers: {\r\n                \"Content-Type\": \"application/json\",\r\n            },\r\n          }\r\n        )\r\n        .then((response) => {\r\n          console.log(response.data);\r\n          setFollowedForum(true); //results\r\n          Swal.fire({\r\n            title: 'Follow Forum',\r\n            text: `You follow forum ${forumId} now`,\r\n            icon: 'success',\r\n          })\r\n        })\r\n        .catch((error) => {\r\n          console.log(\"error in get forum info.\");\r\n        });\r\n  }\r\n\r\n  function unfollowForum() {\r\n    axios\r\n        .patch(BASE_API + `forums/${forumId}/leave/?username=${username}`,{\r\n              headers: {\r\n                \"Content-Type\": \"application/json\",\r\n            },\r\n          }\r\n        )\r\n        .then((response) => {\r\n          console.log(response.data);\r\n          setFollowedForum(false); //results\r\n          Swal.fire({\r\n            title: 'Unfollow Forum',\r\n            text: `You unfollow forum ${forumId}`,\r\n            icon: 'success',\r\n          })\r\n        })\r\n        .catch((error) => {\r\n          console.log(\"error in get forum info.\");\r\n        });\r\n  }\r\n\r\n  const onSubmit = (data) => {\r\n    console.log(\"on submit text:\");\r\n    console.log(data)\r\n    axios\r\n        .post(\r\n            BASE_API + `forums/${forumId}/post/`,\r\n            {\r\n              params: {\r\n                sender: username,\r\n                text: data.text\r\n              },\r\n              headers: {\r\n                  \"Content-Type\": \"application/json\",\r\n              },\r\n            }\r\n        )\r\n        .then((response) => {\r\n            if (check_error(response.data))\r\n                alert(response.data.err_msg)\r\n            else{\r\n              Swal.fire({\r\n                title: 'Post Comment',\r\n                text: `You post a comment now`,\r\n                icon: 'success',\r\n              })\r\n              window.location.reload(false);\r\n            }\r\n        })\r\n        .catch((error) => {\r\n        });\r\n  };\r\n\r\n  while (Forum.messages == undefined){\r\n    return <>Still loading...</>;\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <Sidebar />\r\n      <Navbar />\r\n      <Grid container spacing={2}>\r\n        <Grid container item spacing={2} xs={12} sm={12} md={3}>\r\n          <Grid item xs={12} sm={12} md={12}>\r\n            <ChiefContainer>\r\n              <ChiefH1>پروفایل آشپز {chiefDetail.username}</ChiefH1>\r\n              <ChiefWrapper>\r\n                <ChiefCard>\r\n                  <ChiefImage src={chief_profile_img}></ChiefImage>\r\n                  <ChiefH2>\r\n                    {chiefDetail.first_name} {chiefDetail.last_name}\r\n                  </ChiefH2>\r\n                  <ChiefP>{chiefDetail.bio}</ChiefP>\r\n\r\n                  <a\r\n                    href={\r\n                      \"mailto: \" +\r\n                      chiefDetail.email +\r\n                      \"?subject=Mail from Cookommunity\"\r\n                    }\r\n                  >\r\n                    سوالات خود را بپرسید!\r\n                  </a>\r\n                  <button class=\"mbtn\" hidden={followedChief} onClick={follow_chief}>دنبال کن !</button>\r\n                  <button class=\"mbtn2\" hidden={!followedChief} onClick={unfollow_chief}>دنبال نکن :(</button>\r\n                </ChiefCard>\r\n              </ChiefWrapper>\r\n            </ChiefContainer>\r\n          </Grid>\r\n        </Grid>\r\n        <Grid container item spacing={2} xs={12} sm={12} md={9}>\r\n          <Grid item xs={12} sm={12} md={12}>\r\n            <div className=\"forum_body_area\">\r\n              <div className=\"f-p-container\">\r\n                <h1 className=\"f-title\">فوروم {forumId}</h1>\r\n                <button class=\"mbtn\" hidden={followedForum} onClick={followForum}>دنبال کن !</button>\r\n                <button class=\"mbtn2\" hidden={!followedForum} onClick={unfollowForum}>دنبال نکن :(</button>\r\n              </div>\r\n              <div class=\"forum-post-top\">\r\n                <a class=\"author-avatar\" href=\"#\">\r\n                  <img src={author_avatar} alt=\"author avatar\" />\r\n                </a>\r\n                <div class=\"forum-post-author\">\r\n                  \r\n                  <div class=\"comment-content\">\r\n                    {Forum.messages.map((comment) => (\r\n                      <Grid>\r\n                        <a class=\"author-name\" href=\"#\">\r\n                          {comment.sender}\r\n                        </a>\r\n                        <div class=\"forum-author-meta\">\r\n                          <div class=\"author-badge\">\r\n                            <span>Conversation Starter</span>\r\n                          </div>\r\n                          <div class=\"author-badge\">\r\n                            <i class=\"icon_calendar\"></i>\r\n                            <p>{comment.date}</p>\r\n                          </div>\r\n                        </div>\r\n                        <p>\r\n                          {comment.text}\r\n                        </p>\r\n                      </Grid>\r\n                    ))}\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              <form id=\"review-form\" className=\"review-form\" onSubmit={handleSubmit(onSubmit)}>\r\n                <h4>نظر خود را بنویسید</h4>\r\n                <br />\r\n                <input\r\n                  type=\"text\"\r\n                  placeholder=\"متن\"\r\n                  className=\"form-control\"\r\n                  {...register(\"text\")}\r\n                />\r\n                <button class=\"btn action_btn thm_btn\" type=\"submit\">\r\n                  ثبت نظر\r\n                </button>\r\n              </form>\r\n            </div>\r\n          </Grid>\r\n        </Grid>\r\n      </Grid>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default ForumDetail;\r\n"
        }
    ]
}